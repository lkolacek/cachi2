
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pip/">
      
      
        <link rel="next" href="../yarn/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>yarn classic - Hermeto</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#yarn-classic-yarn-v1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hermeto" class="md-header__button md-logo" aria-label="Hermeto" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hermeto
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              yarn classic
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hermetoproject/hermeto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    hermetoproject/hermeto
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hermeto" class="md-nav__button md-logo" aria-label="Hermeto" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Hermeto
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hermetoproject/hermeto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    hermetoproject/hermeto
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Package managers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Package managers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bundler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bundler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cargo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cargo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    generic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gomod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gomod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../npm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    npm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    yarn classic
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    yarn classic
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-dependencies-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported dependencies types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-dependencies-for-yarn-classic-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Fetching dependencies for Yarn Classic projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites-for-an-offline-build" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites for an offline build
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-and-caveats" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations and caveats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limitations and caveats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yarn-version-specified-anywhere-in-the-package-will-be-ignored-by-prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      Yarn version specified anywhere in the package will be ignored by prefetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yarn-zero-installs-are-not-supported" class="md-nav__link">
    <span class="md-ellipsis">
      Yarn Zero-Installs are not supported
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-of-yarn-specific-config-files" class="md-nav__link">
    <span class="md-ellipsis">
      Handling of yarn-specific config files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-set-during-fetch-phase" class="md-nav__link">
    <span class="md-ellipsis">
      Variables set during fetch phase
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../yarn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    yarn berry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-dependencies-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported dependencies types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-dependencies-for-yarn-classic-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Fetching dependencies for Yarn Classic projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites-for-an-offline-build" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites for an offline build
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-and-caveats" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations and caveats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limitations and caveats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yarn-version-specified-anywhere-in-the-package-will-be-ignored-by-prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      Yarn version specified anywhere in the package will be ignored by prefetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yarn-zero-installs-are-not-supported" class="md-nav__link">
    <span class="md-ellipsis">
      Yarn Zero-Installs are not supported
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-of-yarn-specific-config-files" class="md-nav__link">
    <span class="md-ellipsis">
      Handling of yarn-specific config files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-set-during-fetch-phase" class="md-nav__link">
    <span class="md-ellipsis">
      Variables set during fetch phase
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/hermetoproject/hermeto/edit/main/docs/yarn_classic.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/hermetoproject/hermeto/raw/main/docs/yarn_classic.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="yarn-classic-yarn-v1">Yarn Classic (Yarn v1)<a class="headerlink" href="#yarn-classic-yarn-v1" title="Permanent link">&para;</a></h1>
<p><a href="https://classic.yarnpkg.com/">https://classic.yarnpkg.com/</a></p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#supported-dependencies-types">Supported dependencies types</a></li>
<li><a href="#fetching-dependencies-for-yarn-classic-projects">Fetching dependencies for Yarn Classic projects</a></li>
<li><a href="#prerequisites-for-an-offline-build">Prerequisites for an offline build</a></li>
<li><a href="#limitations-and-caveats">Limitations and caveats</a></li>
<li><a href="#yarn-version-specified-anywhere-in-the-package-will-be-ignored-by-prefetch">Yarn version specified anywhere in the package will be ignored by prefetch</a></li>
<li><a href="#yarn-zero-installs-are-not-supported">Yarn Zero-Installs are not supported</a></li>
<li><a href="#handling-of-yarn-specific-config-files">Handling of yarn-specific config files</a></li>
<li><a href="#variables-set-during-fetch-phase">Variables set during fetch phase</a></li>
</ul>
<p>This document outlines the differences between Yarn Classic and Yarn support.
Please refer to <a href="../yarn/">Yarn documentation</a> for
common aspects of PMs behavior. <code>Yarn</code> and <code>Yarn Classic</code> will be used interchangeably
in this document, any other versions of Yarn will be explicitly mentioned.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Yarn Classic package manager (PM) relies on Yarn Classic being installed on the system
where Hermeto is run. If requested to process a package with Yarn Classic PM it will
check for yarn version and will refuse to proceed if necessary version is missing.
Yarn itself is used by Hermeto under the hood to organize package processing with
some tweaks to ensure that the packages are prepared to be built in isolation.</p>
<p>Hermeto expects to find well-formed <code>package.json</code> and <code>yarn.lock</code> checked in into a
repository and will not continue if any of the files are missing. <code>yarn.lock</code> must be up to
date and all file or path dependencies must be confined to the project repository.</p>
<p>Prefetching dependencies for Yarn in Hermeto is done using Yarn's <a href="https://classic.yarnpkg.com/blog/2016/11/24/offline-mirror/">offline mirror feature</a>.
The project must be configured to use the offline mirror feature. Refer to
<a href="#prerequisites-for-an-offline-build">Prerequisites for an offline build</a> for details.</p>
<h3 id="supported-dependencies-types">Supported dependencies types<a class="headerlink" href="#supported-dependencies-types" title="Permanent link">&para;</a></h3>
<p>Yarn Classic PM is capable of processing the following types of dependencies:
 * packages from registries;
 * packages from git repos;
 * packages from http/https URLs;
 * packages from local paths;
 * local workspace packages;
 * local link packages.</p>
<h2 id="fetching-dependencies-for-yarn-classic-projects">Fetching dependencies for Yarn Classic projects<a class="headerlink" href="#fetching-dependencies-for-yarn-classic-projects" title="Permanent link">&para;</a></h2>
<p>The process of fetching dependencies for Yarn Classic is similar to that for any other
package manager. The name of package manager is <code>yarn_classic</code>, and it does not expect
any additional arguments.</p>
<p>Hermeto <code>fetch-deps</code> shell command:</p>
<pre><code class="language-shell">hermeto fetch-deps \
  --source ./my-repo \
  --output ./hermeto-output \
  '&lt;JSON input&gt;'
</code></pre>
<p>where JSON input is:</p>
<pre><code class="language-jsonc">{
  // &quot;yarn_classic&quot; tells Hermeto to process Yarn packages
  &quot;type&quot;: &quot;yarn_classic&quot;,
  // path to the package (relative to the --source directory)
  // defaults to &quot;.&quot;
  &quot;path&quot;: &quot;.&quot;,
}
</code></pre>
<p>or more simply by just invoking:
<code>hermeto fetch-deps yarn_classic</code></p>
<p>For complete example of how to pre-fetch dependencies, see <a href="../usage/#pre-fetch-dependencies">Pre-fetch dependencies</a>.</p>
<h2 id="prerequisites-for-an-offline-build">Prerequisites for an offline build<a class="headerlink" href="#prerequisites-for-an-offline-build" title="Permanent link">&para;</a></h2>
<p>A project that is to be hermetically built must be configured to use an offline
mirror.  This means that Yarn will store compressed archives on the file system
in a mirror directory and will install them from there later without network
access.</p>
<p>The actual build process will use Yarn directly, thus a project must be
configured to use offline mirror either by providing a <code>.yarnrc</code> file or by
setting up several environment variables. In case when <code>.yarnrc</code> is preferred
it must contain the following lines:</p>
<pre><code class="language-ini">yarn-offline-mirror &lt;absolute path to the request output directory&gt;
yarn-offline-mirror-pruning false
</code></pre>
<p>It can be either directly written to or <code>yarn config</code> could be used:</p>
<pre><code class="language-bash">$ yarn config set yarn-offline-mirror &lt;absolute path to the request output directory&gt;
$ yarn config set yarn-offline-mirror-pruning false
</code></pre>
<p>In case when environment variables approach is preferred the following
variables must be set:</p>
<pre><code class="language-bash">YARN_YARN_OFFLINE_MIRROR=&lt;absolute path to the request output directory&gt;
YARN_YARN_OFFLINE_MIRROR_PRUNING=false
</code></pre>
<p>Hermeto provides a helper that <a href="../usage/#generate-environment-variables">generates these variables</a> and places them into a file.
Sourcing this file is enough to set them.</p>
<h2 id="limitations-and-caveats">Limitations and caveats<a class="headerlink" href="#limitations-and-caveats" title="Permanent link">&para;</a></h2>
<h3 id="yarn-version-specified-anywhere-in-the-package-will-be-ignored-by-prefetch">Yarn version specified anywhere in the package will be ignored by prefetch<a class="headerlink" href="#yarn-version-specified-anywhere-in-the-package-will-be-ignored-by-prefetch" title="Permanent link">&para;</a></h3>
<p>Unlike in the case of Yarn v3 Hermeto will used whichever version is available system-wide
on a system where a package is prefetched. In most practical cases this will default to
the latest stable version of Yarn Classic (which is not under active
development anymore).</p>
<h3 id="yarn-zero-installs-are-not-supported">Yarn Zero-Installs are not supported<a class="headerlink" href="#yarn-zero-installs-are-not-supported" title="Permanent link">&para;</a></h3>
<p>Yarn Classic's <a href="https://classic.yarnpkg.com/en/docs/pnp">Plug'n'Play</a> feature is not supported. Any package that uses
it will be rejected. For further details please refer to [Yarn v3 documentation].</p>
<h3 id="handling-of-yarn-specific-config-files">Handling of yarn-specific config files<a class="headerlink" href="#handling-of-yarn-specific-config-files" title="Permanent link">&para;</a></h3>
<p>Yarn Classic allows a user to provide additional configuration via <a href="https://classic.yarnpkg.com/lang/en/docs/yarnrc/">.yarnrc</a>
and <a href="https://classic.yarnpkg.com/en/docs/cli/cache#toc-change-the-cache-path-for-yarn">.npmrc</a>.  <strong>Hermeto ignores these settings during prefetch phase</strong>.
However a <code>.yarnrc</code> could be used for setting up an offline mirror
(<a href="#prerequisites-for-an-offline-build">Prerequisites for an offline build</a>).  These settings will be applied during
a build phase.</p>
<h3 id="variables-set-during-fetch-phase">Variables set during fetch phase<a class="headerlink" href="#variables-set-during-fetch-phase" title="Permanent link">&para;</a></h3>
<p>The following variables are set for Yarn in the fetch phase:</p>
<ul>
<li><code>COREPACK_ENABLE_DOWNLOAD_PROMPT</code> is set to "0" which prevents
   Corepack from showing the URL when it needs to download software;</li>
<li><code>COREPACK_ENABLE_PROJECT_SPEC</code> is set to "0" which prevents
   Corepack from checking if the package manager corresponds to the one
   defined for the current project;</li>
<li><code>YARN_IGNORE_PATH</code> is set to "true" which ignores any Yarn version specified by a user and
   uses Corepack's version instead;</li>
<li><code>YARN_IGNORE_SCRIPTS</code>: is set to "true" which prevents execution of any scripts defined in
   <code>package.json</code> or in any dependency;</li>
<li><code>YARN_YARN_OFFLINE_MIRROR</code> is set to point to <code>deps/yarn-classic</code> which is relative to
   output directory and will hold fetched dependencies;</li>
<li><code>YARN_YARN_OFFLINE_MIRROR_PRUNING</code> is set to "false" which prevents Yarn from attempting to
   ensure that dependencies are up to date.</li>
</ul>
<p>Once fetch phase is completed Hermeto will need to generate an
<a href="../usage/#generate-environment-variables">environment file</a> with variables pointing to the mirror
and instructing Yarn not to prune it:</p>
<pre><code>YARN_YARN_OFFLINE_MIRROR=&lt;request output directory&gt;
YARN_YARN_OFFLINE_MIRROR_PRUNING=false
</code></pre>
<p>Sourcing this file will prime Yarn for an offline build.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.tooltips", "navigation.sections", "search.share", "search.suggest"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>